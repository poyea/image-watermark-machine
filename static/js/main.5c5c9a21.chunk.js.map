{"version":3,"sources":["styles/Home.module.css","styles/Buttons.module.css","styles/Dragover.module.css","components/Buttons.js","components/Dragover.js","Home.js","utils/color.js","reportWebVitals.js","index.js"],"names":["module","exports","Buttons","props","clearDesk","applyWaterMark","downloadImages","className","styles","buttons","button","onClick","title","Dragover","isDragFocus","zone","focus","id","WATERMARK_STRING","Date","getFullYear","repeat","WATERMARK_FILLSTYLE","color","i","Math","floor","random","rrgb","Home","refStickyContainer","useRef","useState","isSticky","setSticky","files","setFiles","filesArray","setFilesArray","setDragFocus","isDrawn","setDrawn","localWaterMark","setLocalWaterMark","localColor","setLocalColor","addTextToImage","imagePath","text","toModifyCanvas","document","getElementById","context","getContext","img","Image","src","onload","width","height","drawImage","lineWidth","fillStyle","hex","p16","parseInt","substring","g","b","toRGB","lineStyle","font","fillText","mul","yTran","count","save","translate","restore","handleScroll","current","getBoundingClientRect","top","handleDragEnter","handleDragExit","useEffect","window","addEventListener","evt","preventDefault","dataTransfer","handleUploadFiles","removeEventListener","length","push","main","ref","stickybanner","sticky","wrapper","description","type","accept","multiple","onChange","e","target","input","value","v","map","file","idx","alt","URL","createObjectURL","hidden","footer","href","rel","clearRect","forEach","link","createElement","filename","extension","lastIndexOf","name","download","toDataURL","click","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.5c5c9a21.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"main\":\"Home_main__2L4cf\",\"footer\":\"Home_footer__3eZco\",\"title\":\"Home_title__2jL4m\",\"description\":\"Home_description__1txge\",\"stickybanner\":\"Home_stickybanner__Kizvz\",\"wrapper\":\"Home_wrapper__3LREN\",\"sticky\":\"Home_sticky__2Q_3w\",\"logo\":\"Home_logo__3etHn\",\"img\":\"Home_img__3BH-p\",\"hidden\":\"Home_hidden__3JmsZ\",\"input\":\"Home_input__1cYKu\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"buttons\":\"Buttons_buttons__3blPu\",\"button\":\"Buttons_button__2sOd_\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"zone\":\"Dragover_zone__1kqwW\",\"focus\":\"Dragover_focus__1v1qD\"};","import React from 'react';\nimport styles from '../styles/Buttons.module.css';\n\nconst Buttons = (props) => {\n  const { clearDesk, applyWaterMark, downloadImages } = props;\n  return (\n    <div className={styles.buttons}>\n      <button\n        className={styles.button}\n        onClick={clearDesk}\n        title=\"Clear the page.\"\n      >\n        X\n      </button>\n      {/* <button className={styles.button}>+</button> */}\n      <button\n        className={styles.button}\n        onClick={applyWaterMark}\n        title=\"Apply watermarks.\"\n      >\n        A\n      </button>\n      <button\n        className={styles.button}\n        onClick={downloadImages}\n        title=\"Download the edited images.\"\n      >\n        D\n      </button>\n    </div>\n  );\n};\n\nexport default Buttons;\n","import React from 'react';\nimport styles from '../styles/Dragover.module.css';\n\nconst Dragover = (props) => {\n  const { isDragFocus } = props;\n\n  return (\n    <div\n      className={`${styles.zone} ${isDragFocus ? styles.focus : ''}`}\n      id=\"dragover\"\n    >\n      Drop your file(s) here.\n    </div>\n  );\n};\n\nexport default Dragover;\n","import React, { useEffect, useRef, useState } from 'react';\nimport Buttons from './components/Buttons';\nimport Dragover from './components/Dragover';\nimport styles from './styles/Home.module.css';\nimport { rrgb, toRGB } from './utils/color.js';\n\nconst WATERMARK_STRING = `Copyright Â© ${new Date().getFullYear()} J. All Rights Reserved.     `.repeat(\n  100\n);\nconst WATERMARK_FILLSTYLE = rrgb() ?? '#008cff';\nconst WATERMARK_LINESTYLE = '#ffffff';\n\nconst Home = () => {\n  /*\n   * Sticky header hooks.\n   */\n  const refStickyContainer = useRef(null);\n  const [isSticky, setSticky] = useState(false);\n  /*\n   * Files hooks for processing.\n   */\n  const [files, setFiles] = useState({});\n  const [filesArray, setFilesArray] = useState([]);\n\n  const [isDragFocus, setDragFocus] = useState(false);\n\n  const [isDrawn, setDrawn] = useState(false);\n\n  const [localWaterMark, setLocalWaterMark] = useState(WATERMARK_STRING);\n\n  const [localColor, setLocalColor] = useState(WATERMARK_FILLSTYLE);\n\n  const addTextToImage = (imagePath, text, id) => {\n    let toModifyCanvas = document.getElementById(id);\n    let context = toModifyCanvas.getContext('2d');\n    let img = new Image();\n    img.src = imagePath;\n    img.onload = () => {\n      toModifyCanvas.width = img.width;\n      toModifyCanvas.height = img.height;\n      context.drawImage(img, 0, 0);\n      context.lineWidth = 1;\n      context.fillStyle = toRGB(localColor);\n      context.lineStyle = WATERMARK_LINESTYLE;\n      context.font = `${toModifyCanvas.height / 10}px serif`;\n      // context.rotate(Math.PI / 4);\n      context.fillText(text, 0, 0);\n      /*\n       * Drawings\n       */\n      for (let mul = -1; mul <= 1; mul += 2) {\n        for (\n          let xTran = 0, yTran = 0, count = toModifyCanvas.width / 200;\n          count >= 2;\n          count -= 1\n        ) {\n          context.save();\n          context.translate(xTran, yTran);\n          context.fillText(text, 0, 0);\n          context.restore();\n          yTran -= (toModifyCanvas.height / count) * mul;\n        }\n      }\n    };\n  };\n\n  const handleScroll = () => {\n    if (refStickyContainer.current) {\n      setSticky(refStickyContainer.current.getBoundingClientRect().top <= 0);\n    }\n  };\n\n  const applyWaterMark = () => {\n    filesArray.forEach((file, idx) => {\n      addTextToImage(URL.createObjectURL(file), localWaterMark, idx);\n    });\n    setDrawn(true);\n  };\n\n  const clearDesk = () => {\n    for (let i = 0; i < filesArray.length; ++i) {\n      let toModifyCanvas = document.getElementById(i);\n      let context = toModifyCanvas.getContext('2d');\n      context.clearRect(0, 0, toModifyCanvas.width, toModifyCanvas.height);\n    }\n    setFiles({});\n    setFilesArray([]);\n    setDrawn(false);\n  };\n\n  const downloadImages = () => {\n    for (let i = 0; i < filesArray.length && isDrawn; ++i) {\n      let link = document.createElement('a');\n      const filename = files[i]['name'];\n      const extension = filename.substring(filename.lastIndexOf('.') + 1);\n      const name = filename.substring(0, filename.lastIndexOf('.'));\n      link.download = `${name}_watermarked.${extension}`;\n      link.href = document.getElementById(i).toDataURL();\n      link.click();\n    }\n  };\n\n  const handleDragEnter = () => {\n    setDragFocus(true);\n  };\n\n  const handleDragExit = () => {\n    setDragFocus(false);\n  };\n\n  useEffect(() => {\n    window.addEventListener('scroll', handleScroll);\n    window.addEventListener('dragover', (evt) => {\n      handleDragEnter();\n      evt.preventDefault();\n    });\n    window.addEventListener('dragover', (evt) => {\n      handleDragEnter();\n      evt.preventDefault();\n    });\n    window.addEventListener('drop', (evt) => {\n      handleDragExit();\n      setFiles(evt.dataTransfer.files);\n      handleUploadFiles(evt.dataTransfer.files);\n      evt.preventDefault();\n    });\n    window.addEventListener('dragleave', (evt) => {\n      handleDragExit();\n      evt.preventDefault();\n    });\n    document.title = 'Image Watermarker';\n    return () => {\n      window.removeEventListener('scroll', () => handleScroll);\n    };\n  }, []);\n\n  // useEffect(() => {\n  //   console.log(files);\n  // }, [files]);\n\n  const handleUploadFiles = (files) => {\n    if (files.length === 0) {\n      return;\n    }\n    setFiles(files);\n    let filesArray = [];\n    for (let i = 0; i < files.length; ++i) {\n      filesArray.push(files[i]);\n    }\n    setFilesArray(filesArray);\n  };\n\n  const handleInput = (value) => {\n    setLocalWaterMark(value);\n  };\n\n  const handleColor = (value) => {\n    setLocalColor(value);\n  };\n\n  return (\n    <>\n      <main className={styles.main} id=\"main\">\n        <div\n          ref={refStickyContainer}\n          className={`\n            ${isSticky ? styles.stickybanner : ''}\n            `}\n        >\n          <h1\n            className={`\n            ${styles.title} ${\n              isSticky ? styles.sticky + ' ' + styles.wrapper : ''\n            }\n            `}\n          >\n            Image Watermarker\n          </h1>\n        </div>\n        <p className={styles.description}>\n          <input\n            type=\"file\"\n            id=\"input\"\n            files={filesArray}\n            accept=\"image/*\"\n            multiple\n            onChange={(e) => handleUploadFiles(e.target.files)}\n          />\n          <br />\n          <input\n            className={styles.input}\n            type=\"text\"\n            value={localWaterMark}\n            onChange={(v) => handleInput(v.target.value)}\n          ></input>\n          <input\n            className={styles.color}\n            type=\"color\"\n            value={localColor}\n            onChange={(v) => handleColor(v.target.value)}\n          ></input>\n        </p>\n        {filesArray.length > 0 &&\n          filesArray.map((file, idx) => (\n            <div key={idx}>\n              <img\n                id={'img' + idx}\n                alt={file['name']}\n                src={URL.createObjectURL(file)}\n                className={styles.img + (!isDrawn ? '' : ` ${styles.hidden}`)}\n              ></img>\n              <canvas\n                id={idx}\n                className={styles.img + (!isDrawn ? ` ${styles.hidden}` : '')}\n              ></canvas>\n            </div>\n          ))}\n        {filesArray.length === 0 && <Dragover isDragFocus={isDragFocus} />}\n      </main>\n      <footer className={styles.footer}>\n        <a\n          href=\"https://github.com/poyea\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          dev @poyea - {new Date().getFullYear()}\n        </a>\n        <hr></hr>\n        <a\n          href=\"https://github.com/poyea\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          {filesArray.length === 0 && (\n            <img\n              alt=\"@poyea\"\n              src=\"https://avatars3.githubusercontent.com/u/24757020\"\n            ></img>\n          )}\n        </a>\n      </footer>\n\n      <Buttons\n        clearDesk={clearDesk}\n        applyWaterMark={applyWaterMark}\n        downloadImages={downloadImages}\n      />\n    </>\n  );\n};\n\nexport default Home;\n","const toRGB = (hex) => {\n  const p16 = parseInt(hex.substring(1), 16);\n  const r = (p16 >> 16) & 255;\n  const g = (p16 >> 8) & 255;\n  const b = p16 & 255;\n  return `rgb(${r},${g},${b},0.5)`;\n};\n\nconst rrgb = () => {\n  const chars = '0123456789ABCDEF';\n  let color = '#';\n  for (let i = 0; i < 6; i++) {\n    color += chars[Math.floor(Math.random() * 16)];\n  }\n  return color;\n};\n\nexport { toRGB, rrgb };\n","const reportWebVitals = (onPerfEntry) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport Home from './Home';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <Home />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}